; ================================================
; MASTER CONFIGURATION
; ================================================
[platformio]
default_envs = camera_node ; Default to camera if not specified

[env]
platform = espressif32
board = esp32-s3-devkitc-1
framework = arduino
monitor_speed = 115200
; --- Critical Memory Settings for ESP32-S3 (Both boards need this) ---
board_build.arduino.memory_type = qio_opi
board_build.f_flash = 80000000L
board_build.flash_mode = qio
board_build.psram_type = opi
board_upload.flash_size = 8MB
board_upload.maximum_size = 8388608
build_flags = 
    -DBOARD_HAS_PSRAM
    -mfix-esp32-psram-cache-issue
    -D ARDUINO_USB_MODE=1
    -D ARDUINO_USB_CDC_ON_BOOT=1

; ================================================
; ENVIRONMENT 1: THE CAMERA BOARD (ESP32-S3-EYE)
; ================================================
[env:camera_node]
; This filter tells PIO: "Only use main1.cpp, ignore main2.cpp"
build_src_filter = +<main1.cpp> -<main2.cpp>

lib_deps =
    espressif/esp32-camera

; ================================================
; ENVIRONMENT 2: THE SENSOR BOARD (ESP32-S3-DevKit)
; ================================================
[env:sensor_node]
; This filter tells PIO: "Only use main2.cpp, ignore main1.cpp"
build_src_filter = +<main2.cpp> -<main1.cpp>

; Filesystem needed for MP3
board_build.filesystem = spiffs

lib_deps =
    madhephaestus/ESP32Servo
    adafruit/Adafruit BNO055 @ ^1.6.1
    adafruit/Adafruit Unified Sensor @ ^1.1.9
    adafruit/Adafruit BusIO @ ^1.14.5
    earlephilhower/ESP8266Audio @ ^1.9.7
    me-no-dev/ESPAsyncWebServer
    bblanchon/ArduinoJson
